version: '3.9'
services:
  ddns:
    container_name: cloudflare-ddns
    image: timothyjmiller/cloudflare-ddns:latest
    restart: unless-stopped
    
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.icon=https://github.com/kilrah/unraid-docker-templates/raw/main/icons/cloudflare-ddns-config.png

    network_mode: bridge
    environment:
      - HOST_CONTAINERNAME=cloudflare-ddns
    security_opt:
      - no-new-privileges:true
    volumes:
      - ./config/cloudflare-ddns/config.json:/config.json

  tailscale:
    image: deasmi/unraid-tailscale:latest
    container_name: tailscale
    restart: unless-stopped
    network_mode: host
    privileged: true
    security_opt:
      - no-new-privileges:true
    environment:
      - HOST_CONTAINERNAME=tailscale
      - ENABLE_DOWNLOADS=TRUE
      - UP_FLAGS=${TAILSCALE_UP_FLAGS}
    volumes:
      - ./tailscale:/state:rw
      - ./tailscale/downloads:/downloads:rw
    labels:
      - net.unraid.docker.managed=dockerman
      - net.unraid.docker.icon=https://raw.githubusercontent.com/deasmi/unraid-tailscale/master/logo.png
  
  aliyunpan-sync:
    image: tickstep/aliyunpan-sync:v0.2.7
    container_name: aliyunpan-sync
    restart: unless-stopped
    network_mode: bridge
    volumes:
      - ./config/aliyunpan-sync:/home/app/config
      - ${ALIYUNPAN_SYNC_DIR}:/home/app/data:rw
    environment:
      - HOST_CONTAINERNAME=aliyunpan-sync
      - ALIYUNPAN_REFRESH_TOKEN=${ALIYUNPAN_REFRESH_TOKEN}
      - ALIYUNPAN_TRANSFER_URL_TYPE=1
      - ALIYUNPAN_DOWNLOAD_PARALLEL=2
      - ALIYUNPAN_DOWNLOAD_BLOCK_SIZE=10240
      - ALIYUNPAN_UPLOAD_PARALLEL=2
      - ALIYUNPAN_UPLOAD_BLOCK_SIZE=10240
      - ALIYUNPAN_PAN_DIR=${ALIYUNPAN_PAN_DIR}
      - ALIYUNPAN_SYNC_MODE=sync
      - ALIYUNPAN_SYNC_PRIORITY=time
      - ALIYUNPAN_SYNC_LOG=true
      - ALIYUNPAN_LOCAL_DELAY_TIME=10
      - ALIYUNPAN_TASK_STEP=sync

